#!/usr/bin/env ruby
require 'net/https'
require 'uri'
require 'openssl'

$url = "https://lvh.me"

command = [];
command.push "curl -vv"
command.push "--cacert output/server_publ.crt"
command.push "--key output/client_priv.key.nopass"
command.push "--cert output/client_publ.crt"
command.push $url
command = command.join(' ')
puts "---------------------------"
puts "EXECUTING:"
puts command
puts "---------------------------"
system(command)

puts "EXPECTING THIS TO FAIL: "
puts `curl --cacert output/server_publ.crt #{$url}`